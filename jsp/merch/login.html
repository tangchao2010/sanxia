<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="renderer" content="webkit" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">  <!--删除默认的苹果工具栏和菜单栏-->
        <meta name="apple-mobile-web-app-status-bar-style" content="black"> <!-- 控制状态栏显示样式-->
		<title>用户登陆</title>
        <!--新增-->
        <link rel="stylesheet" href="../../css/sm/sm.min.css">
		<link rel="stylesheet" href="../../css/sm/mystyle.css">
		<link rel="stylesheet" href="../../css/sm/font-awesome.min.css">
	</head>

	<body>
    <div class="page-group">
		<div class="page page-current">
        	<header class="bar bar-nav">
               <!-- <a class="icon icon-left pull-left back"></a>-->
                <h1 class='title'>用户登录</h1>
            </header>
    
    	<div class="content">
            <span class="wcb_logo">
            	<img src="../../img/wcb/sanxialogob.png"/>
            </span>
            
            <form  id="defaultForm" method="post" action="" >
				<!--<input type="hidden" id="openid" name="openid" value="<%=request.getParameter("openid") %>">
				<input type="hidden" id="oemid" name="oemid" value="<%=request.getParameter("oemid") %>">
				<input type="hidden" id="tjmrchorgcode" name="tjmrchorgcode" value="<%=request.getParameter("mrchorgcode") %>">
                <input type="hidden" id="qrcode" name="qrcode" value="<%=request.getParameter("qrcode") %>">-->
                    <div class="list-block">
                        <ul>
                            <li>
                                <div class="item-content">
                                    <div class="item-media"></div>
                                    <div class="item-inner">
                                        <div class="item-title label ">手机号</div>
                                        <div class="item-input">
                                            <input type="tel" id="phoneNo"  name="phoneNo"  maxlength="11" placeholder="手机号" >
                                        </div>
                                    </div>
                                </div>
                            </li>

                            <li>
                                <div class="item-content">
                                    <div class="item-media"></div>
                                    <div class="item-inner">
                                        <div class="item-title label ">验证码</div>
                                        <div class="item-input">
                                            <input type="tel" maxlength="6" id="validCode" name="validCode" value="" placeholder="请输入验证码">
                                        </div>
                                        <div class="item-after">
                                        	<input id="btn-loadCode" type="button" class="obtain_code alert-text" value="获取验证码">
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div class="content-block">
                        <div class="row">
                            <div class="col-100"><button type="button" id="tcashbc"  onclick="oncelogin()" type="button" class="button button-block button-fill button-big "> 立即登录</button></div>
                        </div>
                    </div>
                    <div class="once_zc">还没有账号？<a href="#" onclick="an()">立即注册</a></div>
                </form>
        	</div>
            
		</div>
    </div>
    
	<script type="text/javascript" src="../../js/sm/jquery-3.1.min.js"></script>
	<script type="text/javascript" src="../../js/sm/mypublic.js"></script>
    <script type="text/javascript" src="../../js/sm/sm.min.js"></script>
     
	<script type="text/javascript">
    	function an(){
                window.location.href="../merch/merch_registery.html"
                $.showIndicator();
		}

		$(function() {
				/*function sendValidCode() {
					$.post("<%=request.getContextPath()%>/LoginReg/sendValidCode", {
						phoneNo: $("input[name='phoneNo']").val(),
						oemid  : $("input[name='oemid']").val()
					}, function(json) {						
						if(json.code != 0) {
							var loading = layer.open({
								type: 3,
								content: json.desc
							});
						setTimeout(an,"1500");
						}
					}, "json");
				
				}*/
				
				/*$("#btn-loadCode").on("click", function() {
					var $Validator = $('#defaultForm').data('bootstrapValidator');
					$Validator.validateField("phoneNo");
					var valid = $Validator.isValidField("phoneNo");
					if(!valid) return false;

					var btn = $(this);
					var orgHtml = btn.html();
					btn.attr("disabled", "disabled");
					sendValidCode();
					var progress = 60;
					btn.html("重新申请(" + progress + ")");
					var interval = setInterval(function() {
						progress--;
						btn.html("重新申请(" + progress + ")");
						if(progress === 1) {
							btn.html(orgHtml);
							btn.removeAttr("disabled");
							clearInterval(interval);
						}
					}, 1000);
				});
				*/
		});
		
		/*<!--$.post($form.attr('action'), $form.serialize(), function(result) {
						layer.close(loading);
						if(result.code == 0) {
							var username = $("input[name='phoneNo']").val();
							var password=$("input[name='password']").val();
							var openid=$("input[name='openid']").val();
							var oemid=$("input[name='oemid']").val();
							var tjmrchorgcode=$("input[name='tjmrchorgcode']").val();
							var qrcode=$("input[name='qrcode']").val();

							window.location.href = "<%=request.getContextPath()%>/LoginReg/login?openid=" + openid + "&username=" + username + "&password="+password + "&oemid="+oemid + "&tjmrchorgcode="+tjmrchorgcode + "&qrcode="+qrcode;
						} else {
							/!*layer.open({
								type: 3,
								content: result.desc
							});*!/
							alert(1);
						}
					}, 'json');*/
    </script>
       
	<script type="text/javascript">
			//验证码
			/*var wait = 60;
				function towait() {
					if (wait == 0) {
						$("#send_code").removeAttr("disabled");
						$("#send_code").attr("value", "发送验证码");
						wait = 60;
					} else {
						$("#send_code").attr("disabled", true);
						$("#send_code").attr("value", "重新发送(" + wait + "s)");
						wait--;
						setTimeout(function() {        
							towait();
						}, 1000);
					}
			}	*/
			
			//登录
			function oncelogin(){
				if(checkSmsLoginPhone() && checkCode()){
					// $("#defaultForm").submit();
                    $.alert('您还没有注册!', function () {
                        window.location.href='merch_registery.html';
                        $.showIndicator();
                    });
                    // window.location.href = "login_suc.html";
					$('#tcashbc').attr("disabled",true); 
				}
				else{
					return false;	
				}
			}
			
			//登录手机号判断
			$(function(){
				$("#btn-loadCode").on('click',function () {
					var url = '';
				
					var phoneNo=$("#phoneNo").val();
					if(phoneNo==''){
						$.alert('手机号不能为空');
						return;
					}
					if(!isMobile(phoneNo)){
						$.alert("手机号码格式不正确！");
						return;
					}
					towait();
				});
			});
			
			//提交时检查手机号
			function checkSmsLoginPhone(){
				var phoneNo = $('#phoneNo').val();   
				if (phoneNo == null || phoneNo == "" ) { // !(/^1(3|4|5|7|8)\d{9}$/.test(uname))  手机号正则
					$.alert("请输入手机号！");
					return false;
				}
				if(!isMobile(phoneNo)){
					$.alert("手机号码格式不正确！");
					return false;
				}
				return true;
			}
			
			//手机号格式判断 
			function isMobile(object){
				var pattern = /^1(3|4|5|7|8)\d{9}$/; //原 /^[1]\d{10}$/;  
				return pattern.test(object);
			};	
			
			//检查验证码
			var checkCode = function() {
				var validCode = $("#validCode").val();
                if (validCode == null || validCode == "") {
					$.alert("请输入手机验证码");
					return false;
				}else{
					return true;
				}
			}
	</script>  
	</body>
</html>